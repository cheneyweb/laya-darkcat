var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function o(s,r,l){function c(t,e){if(!r[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}var i=r[t]={exports:{}};s[t][0].call(i.exports,function(e){return c(s[t][1][e]||e)},i,i.exports,o,s,r,l)}return r[t].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),i=u(e("./script/Guide")),o=u(e("./view/GameUI")),s=u(e("./script/GameDirector")),r=u(e("./script/Enemy")),l=u(e("./script/Soldier")),c=u(e("./script/Gold"));function u(e){return e&&e.__esModule?e:{default:e}}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"init",value:function(){var e=Laya.ClassUtils.regClass;e("script/Guide.js",i.default),e("view/GameUI.js",o.default),e("script/GameDirector.js",s.default),e("script/Enemy.js",r.default),e("script/Soldier.js",l.default),e("script/Gold.js",c.default)}}]),e}();(n.default=y).width=640,y.height=1336,y.scaleMode="exactfit",y.screenMode="vertical",y.alignV="middle",y.alignH="center",y.startScene="GameMain.scene",y.sceneRoot="",y.debug=!1,y.stat=!1,y.physicsDebug=!1,y.exportSceneToJson=!0,y.init()},{"./script/Enemy":3,"./script/GameDirector":4,"./script/Gold":5,"./script/Guide":6,"./script/Soldier":7,"./view/GameUI":9}],2:[function(e,t,n){"use strict";var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),i=s(e("./GameConfig")),o=s(e("./util/Store"));function s(e){return e&&e.__esModule?e:{default:e}}new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Laya.store=o.default,Laya.Browser.onMiniGame?(wx.showShareMenu({withShareTicket:!0}),wx.onShareAppMessage(function(){return{title:o.default.state.shareTitle,imageUrl:canvas.toTempFilePathSync({destWidth:500,destHeight:400})}}),wx.cloud.init(),Laya.store.actions.login("wx")):Laya.store.actions.login(),window.Laya3D?Laya3D.init(i.default.width,i.default.height):Laya.init(i.default.width,i.default.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=i.default.scaleMode,Laya.stage.screenMode=i.default.screenMode,Laya.stage.alignV=i.default.alignV,Laya.stage.alignH=i.default.alignH,Laya.URL.exportSceneToJson=i.default.exportSceneToJson,(i.default.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),i.default.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),i.default.stat&&Laya.Stat.show(),Laya.alertGlobalError=!0,Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}return a(e,[{key:"onVersionLoaded",value:function(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}},{key:"onConfigLoaded",value:function(){i.default.startScene&&Laya.Scene.open(i.default.startScene)}}]),e}())},{"./GameConfig":1,"./util/Store":8}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),o=e("../view/GameUI");(a=o)&&a.__esModule;var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Laya.Script),i(t,[{key:"onEnable",value:function(){this._store=Laya.store,this._velocity={x:0,y:0},this._velocityBase=.5,this._velocityRange=1,this._soldier=null,this.owner.visible=!0,this.rigidBody=this.owner.getComponent(Laya.RigidBody),this.ani=this.owner.getChildByName("ani"),this._free()}},{key:"onUpdate",value:function(){this._checkRange()}},{key:"onTriggerEnter",value:function(e,t,n){"soldier"==e.label&&(this._soldier=e.owner.getComponent(Laya.Script),(this._soldier.isFreedom()||this._soldier._mouseCatched==this)&&this.owner.removeSelf())}},{key:"onDisable",value:function(){10<this._store.state.player.level?Laya.Pool.recover("blackcat",this.owner):Laya.Pool.recover("enemy",this.owner),Laya.store.actions.delEnemy(this.owner)}},{key:"_checkRange",value:function(){this.owner.y<this._store.state.upRange?(this._velocity.y*=-1,this._velocity.x=Math.random()*this._velocityRange+this._velocityBase,this._velocity.x*=.5<Math.random()?1:-1,this._setVelocity()):this.owner.y>Laya.stage.height-this._store.state.downRange?(this._velocity.y*=-1,this._velocity.x=Math.random()*this._velocityRange+this._velocityBase,this._velocity.x*=.5<Math.random()?1:-1,this._setVelocity()):this.owner.x<0?(this._velocity.x*=-1,this._velocity.y=Math.random()*this._velocityRange+this._velocityBase,this._velocity.y*=.5<Math.random()?1:-1,this._setVelocity()):this.owner.x>Laya.stage.width&&(this._velocity.x*=-1,this._velocity.y=Math.random()*this._velocityRange+this._velocityBase,this._velocity.y*=.5<Math.random()?1:-1,this._setVelocity())}},{key:"_free",value:function(){this._velocity.x=Math.random()*this._velocityRange+this._velocityBase,this._velocity.y=Math.random()*this._velocityRange+this._velocityBase,this._velocity.x*=.5<Math.random()?1:-1,this._velocity.y*=.5<Math.random()?1:-1,this._setVelocity()}},{key:"_setVelocity",value:function(){0<this._velocity.x?this.ani.scale(1,1,!0):this.ani.scale(-1,1,!0),this.rigidBody.setVelocity(this._velocity)}}]),t}();n.default=s},{"../view/GameUI":9}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),o=e("../view/GameUI"),s=(a=o)&&a.__esModule?a:{default:a};var r=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return t.instance=e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Laya.Script),i(t,[{key:"onEnable",value:function(){this._store=Laya.store,this._isRunning=!1,this._clickCount=0,this._lastHeartTime=Date.now(),this.bg=this.owner.getChildByName("bg"),this.spriteBox=this.owner.getChildByName("spriteBox"),this.guide=this.owner.getChildByName("guide")}},{key:"onUpdate",value:function(){this._isRunning&&Date.now()-this._lastHeartTime>2e4*Math.random()+1e4&&(this._lastHeartTime=Date.now(),s.default.instance.releaseFood(1))}},{key:"onStageClick",value:function(e){if(e.stopPropagation(),this._isRunning&&0<this._clickCount++&&e.stageY>this._store.state.upRange&&e.stageY<Laya.stage.height-this._store.state.downRange&&this.cat){var t=this.cat.getComponent(Laya.Script);t.isFreedom()&&(this.guide.pos(e.stageX,e.stageY),this.guide.visible=!0,t.guide(e))}}},{key:"run",value:function(){this._isRunning=!0,this.bg.visible=!0,this._createSoldier()}},{key:"pauseGame",value:function(){this._isRunning=!1}},{key:"continueGame",value:function(){this._isRunning=!0}},{key:"stop",value:function(){this._isRunning=!1,this.bg.visible=!1,this.guide.visible=!1,this.spriteBox.removeChildren()}},{key:"releaseFood",value:function(){this._createEnemy()}},{key:"releaseGold",value:function(){this._createGold()}},{key:"_createGold",value:function(){var e=Laya.Pool.getItemByCreateFun("goldpack",this.goldpack.create,this.goldpack),t=Laya.stage.width-e.width,n=Laya.stage.height-this._store.state.upRange-this._store.state.downRange;e.pos(Math.random()*t+e.width,Math.random()*n+this._store.state.upRange),this.spriteBox.addChild(e),this._store.actions.addGold(e)}},{key:"_createEnemy",value:function(){var e=void 0;e=10<this._store.state.player.level?Laya.Pool.getItemByCreateFun("blackcat",this.blackcat.create,this.blackcat):Laya.Pool.getItemByCreateFun("enemy",this.enemy.create,this.enemy);var t=Laya.stage.height-this._store.state.upRange-this._store.state.downRange;.5<Math.random()?e.pos(e.width,Math.random()*t+this._store.state.upRange):e.pos(Laya.stage.width,Math.random()*t+this._store.state.upRange),this.spriteBox.addChild(e),this._store.actions.addEnemy(e)}},{key:"_createSoldier",value:function(e){this.cat=this.soldier.create(),e?this.cat.pos(e.stageX,e.stageY):this.cat.pos(Laya.stage.width/2,Laya.stage.height/2),this.owner.addChild(this.cat)}}]),t}();n.default=r},{"../view/GameUI":9}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),o=e("../view/GameUI"),s=(a=o)&&a.__esModule?a:{default:a};var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Laya.Script),i(t,[{key:"onEnable",value:function(){}},{key:"onTriggerEnter",value:function(e,t,n){"soldier"==e.label&&(this._soldier=e.owner.getComponent(Laya.Script),this._soldier.isFreedom()&&(Laya.SoundManager.playSound("sound/gold.mp3"),s.default.instance.earnGold("pick",this.owner),this.owner.removeSelf()))}},{key:"onUpdate",value:function(){}},{key:"onDisable",value:function(){Laya.Pool.recover("goldpack",this.owner),Laya.store.actions.delGold(this.owner)}}]),t}();n.default=r},{"../view/GameUI":9}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();var i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Laya.Script),a(t,[{key:"onEnable",value:function(){}},{key:"onTriggerEnter",value:function(e,t,n){"soldier"==e.label&&e.owner.getComponent(Laya.Script).isFreedom()&&(Laya.SoundManager.playSound("sound/tease.mp3"),this.owner.visible=!1,this.owner.pos(0,0))}},{key:"onUpdate",value:function(){}},{key:"onDisable",value:function(){}}]),t}();n.default=i},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),o=e("../view/GameUI"),s=(a=o)&&a.__esModule?a:{default:a};var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Laya.Script),i(t,[{key:"onEnable",value:function(){var e=this;this._store=Laya.store,this._velocity={x:0,y:0},this._velocityBase=1,this._velocityRange=1.5,this._mouseCatched=null,this._isEvolution=!1,this._isTease=!1,this.aniCat=this.owner.getChildByName("aniCat"),this.aniEat=this.owner.getChildByName("aniEat"),this.aniTease=this.owner.getChildByName("aniTease"),this.rigidBody=this.owner.getComponent(Laya.RigidBody),this.aniEat.on(Laya.Event.COMPLETE,null,function(){e._afterEat()}),this.aniTease.on(Laya.Event.COMPLETE,null,function(){e._free()}),this._free()}},{key:"onUpdate",value:function(){this._checkRange()}},{key:"onTriggerEnter",value:function(e,t,n){"mouse"===e.label?this.isFreedom()&&(this._mouseCatched=e.owner.getComponent(Laya.Script),10<this._store.state.player.level?Laya.SoundManager.playSound("sound/cat.mp3"):Laya.SoundManager.playSound("sound/mouse.mp3"),0<this._velocity.x?this.aniEat.scale(-1,1,!0):this.aniEat.scale(1,1,!0),this.aniCat.visible=!1,this.aniTease.visible=!1,this.aniEat.visible=!0,this.aniEat.play(0,!1),this._velocityTemp=this._velocity,this._velocity={x:0,y:0}):"guide"===e.label&&this.isFreedom()&&(this._isTease=!0,this.aniCat.visible=!1,this.aniEat.visible=!1,this.aniTease.visible=!0,this.aniTease.play(0,!1),this._velocity={x:0,y:0}),this._setVelocity()}},{key:"onDisable",value:function(){}},{key:"isFreedom",value:function(){return!this._mouseCatched&&!this._isEvolution&&!this._isTease}},{key:"guide",value:function(e){this.isFreedom()&&(this._velocity.x=(e.stageX-this.owner.x)/100,this._velocity.y=(e.stageY-this.owner.y)/100,this._setVelocity())}},{key:"_afterEat",value:function(){var n=this;this._mouseCatched=null,this.aniEat.visible=!1,this.aniTease.visible=!1,this.aniCat.visible=!0,Laya.SoundManager.playSound("sound/destroy.wav"),this._velocityTemp&&(this._velocity=this._velocityTemp,this._velocityTemp=null),Laya.store.actions.eat().then(function(e){if(s.default.instance.updateExp(e.player.progressValue),s.default.instance.updatePrice(e.price),e.token){n._isEvolution=!0,Laya.SoundManager.playSound("sound/evo.mp3"),s.default.instance.changeGameBG("bg/bg_blue.jpg");var t=Laya.Pool.getItemByCreateFun("evolution",n._createEvolution,n);t.pos(n.owner.x,n.owner.y),n.owner.parent.addChild(t),t.play(0,!1),n._velocity={x:0,y:0}}10<n._store.state.player.level&&s.default.instance.updateBtnFood(),n._setVelocity()})}},{key:"_free",value:function(){this._isEvolution=!1,this._isTease=!1,this.aniEat.visible=!1,this.aniTease.visible=!1,this.aniCat.visible=!0,this._velocity.x=Math.random()*this._velocityRange+this._velocityBase,this._velocity.y=Math.random()*this._velocityRange+this._velocityBase,this._velocity.x*=.5<Math.random()?1:-1,this._velocity.y*=.5<Math.random()?1:-1,this._setVelocity()}},{key:"_checkRange",value:function(){this.owner.y<this._store.state.upRange?(this._velocity.y*=-1,this._velocity.x=Math.random()*this._velocityRange+this._velocityBase,this._velocity.x*=.5<Math.random()?1:-1,this._setVelocity()):this.owner.y>Laya.stage.height-this._store.state.downRange?(this._velocity.y*=-1,this._velocity.x=Math.random()*this._velocityRange+this._velocityBase,this._velocity.x*=.5<Math.random()?1:-1,this._setVelocity()):this.owner.x<0?(this._velocity.x*=-1,this._velocity.y=Math.random()*this._velocityRange+this._velocityBase,this._velocity.y*=.5<Math.random()?1:-1,this._setVelocity()):this.owner.x>Laya.stage.width&&(this._velocity.x*=-1,this._velocity.y=Math.random()*this._velocityRange+this._velocityBase,this._velocity.y*=.5<Math.random()?1:-1,this._setVelocity())}},{key:"_setVelocity",value:function(){(this._velocity.x||this._velocity.y)&&(this.aniCat.source="ani/cat/Cat"+this._store.state.player.level+".ani",this.aniEat.source="ani/eat/Eat"+this._store.state.player.level+".ani",this.aniTease.source="ani/tease/Cat"+this._store.state.player.level+".ani",0<this._velocity.x?this.aniCat.scale(-1,1,!0):this.aniCat.scale(1,1,!0)),this.rigidBody.setVelocity(this._velocity)}},{key:"_createEvolution",value:function(){var e=this,t=new Laya.Animation;return t.loadAnimation("ani/Bomb.ani"),t.on(Laya.Event.COMPLETE,null,function(){s.default.instance.changeGameBG("bg/bg_dark.jpg"),t.removeSelf(),Laya.Pool.recover("evolution",t),e._free()}),t.scale(2,2,!0),t}},{key:"_createExplode",value:function(){var e=new Laya.Animation;return e.loadAnimation("ani/Explode.ani"),e.on(Laya.Event.COMPLETE,null,function(){e.removeSelf(),Laya.Pool.recover("explode",e)}),e}}]),t}();n.default=r},{"../view/GameUI":9}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(){i(this,e),new Laya.HttpRequest,this.domain="https://darkcat.xserver.top"}return a(e,[{key:"get",value:function(a){var i=this;return new Promise(function(t,n){var e=new Laya.HttpRequest;e.http.timeout=1e4,e.once(Laya.Event.COMPLETE,i,function(e){t(e)}),e.once(Laya.Event.ERROR,i,function(e){console.error(e),n(e)}),e.send(""+i.domain+a,"","get","json",["content-type","application/json;charset=UTF-8","token",s.state.token])})}},{key:"post",value:function(a,i){var o=this;return new Promise(function(t,n){var e=new Laya.HttpRequest;e.http.timeout=1e4,e.once(Laya.Event.COMPLETE,o,function(e){t(e)}),e.once(Laya.Event.ERROR,o,function(e){console.error(e),n(e)}),e.send(""+o.domain+a,JSON.stringify(i),"post","json",["content-type","application/json;charset=UTF-8","token",s.state.token])})}}]),e}(),s=new(function(){function t(e){i(this,t),this.state=e.state,this.actions=e.actions,this.axios=new o}return a(t,[{key:"clear",value:function(){return Laya.LocalStorage.clear()}},{key:"pGetItem",value:function(e){return Laya.LocalStorage.getItem(e)?JSON.parse(Laya.LocalStorage.getItem(e)):null}},{key:"pSetItem",value:function(e,t){return Laya.LocalStorage.setItem(e,JSON.stringify(t))}}]),t}())({state:{upRange:320,downRange:220,storyIndex:0,storyArr:["9.22 星期天\n\n今天我在路边捡到了一只可爱的小猫！\n她实在是太可爱了，我给他起名叫大黑。\n从今天开始，我每天都要为她写日记。\n\n一回到家，她就开始在我的屋里抓耗子！真乖…\n\n但是妈妈很讨厌猫，我要把她藏起来，\n不能让妈妈看到。","9.23 星期一\n\n今天她突然开始用两只脚走路了！！\n她也太擅长模仿了吧！！\n用手抓耗子的样子也忒可爱了！\n\n你看她一扭一扭魔性的样子，\n真是一只聪明的大黑。","10.6 星期五\n\n她长的太快了，几天不见已经变化好大！\n但是妈妈到底还是发现了她…\n妈妈她很不开心，非常的生气…\n\n也不知道为啥子，大黑这么可爱，\n妈妈怎么就是不喜欢呢？","11.8 星期二\n\n昨天，大黑不见了…\n可能是妈妈把她给扔掉了…\n\n但是她真的好聪明，今天居然自己找了回来！\n\n然而不知道为什么，她肚脐下面全是腿…!\n\n但是还是那么可爱~~","12.12 星期四\n\n今天双十二，妈妈已经一周没有出过她房间了。\n也不给我做饭，饿死我了。\n\n大黑今天也很奇怪，突然开口跟我说话了！！\n\n她什么时候学会说话的？？？","12.14 星期六\n\n今天到了很多快递，大黑也越来越与众不同了。\n在与大黑的相处过程中，她教会了我许多东西。\n我觉得我再也不用去学校了！\n\n妈妈不知道哪去了，从上次我就再没见过她。\n她的房间里也不时的传出一些怪味。\n\n不过没关系，还有大黑陪着我。\n而且我好像也变得奇怪了起来。\n我们会永远在一起。","??.?? 星期？\n\n我在时空中漂泊。看尽了世间百态。\n人类的崛起、进化、战争、和平、文明…还有爱。\n\n而这一切，大黑都与之相关，大黑启示录。","??.?? 星期？\n\n时空扭转。\n伊人已逝。\n\n大黑接受不了残酷的现实，\n大黑只得向着更高的层次进化。\n\n宇宙规则已经改变…","??.?? 星期？\n\n大黑修改了宇宙法则，成为这个宇宙新的神祇。\n能力越大责任越大，\n现在她将承担起对抗邪恶的任务。\n\n最后的战役即将打响。\n\n或许，大黑是孤独的，但她知道，\n主人永远相伴她的左右。","??.?? 星期？\n\n喵即宇宙，宇宙即喵。\n太极生两仪，两仪生四象，\n四象生八卦，八卦生万物。\n\n新的世界混沌初开，只是不知是否还能遇到主人。\n\n而大黑的旅程却从未停止…","??.?? 星期？\n\n创世神大黑一直在搜寻主人的踪迹，但毫无所得。\n一怒之下打开时空裂缝进入多元宇宙。\n\n融合了多元宇宙力量的大黑拥有更加强大的力量。\n但多元宇宙中的邪恶化身也感染了她。\n\n大黑陷入了与心魔的斗争中…","大黑元年，1月1日，猫旦\n\n最终，大黑在与心魔的斗争中，自我意识胜出。\n\n而在此过程中，神格打成，新一代猫神就此诞生！"],token:null,player:{exp:0,level:0,gold:0,progressValue:0},shareTitle:"这猫长这样我也是醉了...",enemyMap:new Map,goldMap:new Map},actions:{login:function(a){return new Promise(function(n,e){if("wx"==a)wx.cloud.callFunction({name:"login",data:{}}).then(function(e){var t=s.pGetItem("player")||s.state.player;t.openid=e.result.openid,s.axios.post("/xserver/player/login",t).then(function(e){s.state.player=e.player,s.state.token=e.token,s.state.shareTitle=e.shareTitle,s.pSetItem("player",e.player),n(e)})}).catch(console.error);else{var t=s.pGetItem("player")||s.state.player;s.axios.post("/xserver/player/login",t).then(function(e){s.state.player=e.player,s.state.token=e.token,s.pSetItem("player",e.player),n(e)})}})},earn:function(n){return new Promise(function(t,e){s.axios.get("/xserver/player/earn?type="+n).then(function(e){e.err||(s.state.player=e.player,t(e),s.pSetItem("player",s.state.player))})})},buy:function(n){return new Promise(function(t,e){s.axios.get("/xserver/player/buy?isRandom="+n).then(function(e){e.err||(s.state.player=e.player,s.pSetItem("player",s.state.player)),t(e)})})},eat:function(){return new Promise(function(t,e){s.axios.get("/xserver/player/eat").then(function(e){s.state.player=e.player,t(e),s.pSetItem("player",s.state.player),e.token&&(s.state.token=e.token)})})},moveStoryIndex:function(e){var t=s.state.storyIndex+e;return t>=s.state.player.level?t=s.state.player.level-1:t<0&&(t=0),s.state.storyIndex=t,s.state.storyIndex},restoreStoryIndex:function(){s.state.storyIndex=s.state.player.level-1},addEnemy:function(e){s.state.enemyMap.set(e,e)},delEnemy:function(e){s.state.enemyMap.delete(e)},addGold:function(e){s.state.goldMap.set(e,e)},delGold:function(e){s.state.goldMap.delete(e)}}});n.default=s},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),o=e("../script/GameDirector"),s=(a=o)&&a.__esModule?a:{default:a};var r=function(e){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return n.instance=t,Laya.MouseManager.multiTouchEnabled=!1,Laya.Browser.onMiniGame&&(Laya.MiniAdpter.window.wx.onShow(function(){Laya.store.actions.login("wx").then(function(e){t._restoreUI(e)}),Laya.SoundManager.playMusic("sound/bgm.mp3")}),Laya.MiniAdpter.window.wx.onHide(function(){console.log("小游戏隐藏到后台")})),t.loadScene("GameUI.scene"),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,Laya.Scene),i(n,[{key:"onEnable",value:function(){this._store=Laya.store,this._director=s.default.instance,this._loadResource()}},{key:"onStageClick",value:function(e){e.stopPropagation()}},{key:"_loadResource",value:function(){var t=this;this.btnStart.label="加载中...",Laya.loader.load(["bg/bg_dark.jpg","bg/bg_blue.jpg","res/atlas/ani/gold.atlas","res/atlas/ani/effect.atlas","res/atlas/ani/evolution.atlas"],Laya.Handler.create(this,function(e){1<t._store.state.player.level||0<t._store.state.player.exp?(t._director._clickCount++,t.beginGame()):(t.btnStart.label="点击领养",t.btnStart.on(Laya.Event.CLICK,t,t.beginGame,[!0]))}),Laya.Handler.create(this,function(e){t.btnStart.label="加载中 "+(100*e).toFixed(2)+"%"},null,!1)),this.btnFood.on(Laya.Event.CLICK,this,this.releaseFood),this.btnGold.on(Laya.Event.CLICK,this,this.earnGold,["ad"]),this.dialogTip.getChildByName("btnTip").on(Laya.Event.CLICK,this,this.earnGold,["ad"]),this.btnShare.on(Laya.Event.CLICK,this,this.share),this.btnDiary.on(Laya.Event.CLICK,this,this.diaryOpen),this.dialogDiary.closeHandler=new Laya.Handler(this,this.diaryClose),this.dialogDiary.getChildByName("btnLeft").on(Laya.Event.CLICK,this,this.diaryLeft),this.dialogDiary.getChildByName("btnRight").on(Laya.Event.CLICK,this,this.diaryRight),this.btnGift.on(Laya.Event.CLICK,this,this.giftOpen),this.dialogGift.getChildByName("btnGift").on(Laya.Event.CLICK,this,this.earnGold,["gift"]),this.dialogGift.closeHandler=new Laya.Handler(this,this.giftClose)}},{key:"_restoreUI",value:function(e){this.labelGold.changeText("x"+this._store.state.player.gold),this.updateExp(this._store.state.player.progressValue),this.updatePrice(this._store.state.player.price),10<this._store.state.player.level&&this.updateBtnFood(),e.goldInc&&(this.dialogGift.getChildByName("labelTip").changeText("猫币奖励 x"+e.goldInc),this.btnGift.visible=!0)}},{key:"_pickGold",value:function(){this.textGold.visible=!1}},{key:"beginGame",value:function(e){var t=this;this.btnStart.visible=!1,this.labelLaw.visible=!1,this.labelCopyright.visible=!1,this.titleLogo.visible=!1;var n=Laya.Browser.onMiniGame?"wx":null;Laya.store.actions.login(n).then(function(e){t._restoreUI(e),t.btnFood.visible=!0,t.btnGold.visible=!0,n&&(t.btnShare.visible=!0),t.btnDiary.visible=!0,t.progressExp.visible=!0,t.labelGold.visible=!0,t.imgGold.visible=!0}),this._director.run(),Laya.SoundManager.playMusic("sound/bgm.mp3"),e&&this.diaryOpen()}},{key:"endGame",value:function(){this.btnStart.visible=!0,this.btnFood.visible=!1,this.btnGold.visible=!1,this.btnShare.visible=!1,this.btnDiary.visible=!1,this.progressExp.visible=!1,this.labelGold.visible=!1,this.imgGold.visible=!1,this.labelLaw.visible=!1,this.labelCopyright.visible=!1,this.titleLogo.visible=!0,this._director.stop()}},{key:"changeGameBG",value:function(e){this._director.bg.texture=e}},{key:"releaseFood",value:function(e){var t=this;this._store.state.enemyMap.size<10&&(Laya.SoundManager.playSound("sound/hit.wav"),this._store.actions.buy(e).then(function(e){e.err?(t.btnFood.label=e.msg,t.dialogTip.visible=!0,t.dialogTip.show()):(t.labelGold.changeText("x"+e.player.gold),t._director.releaseFood(),1==e.isGold&&t._store.state.goldMap.size<3&&t._director.releaseGold())}))}},{key:"earnGold",value:function(t,n){var a=this;this._store.actions.earn(t).then(function(e){e.err||("pick"==t&&(a.textGold.text="猫币+"+e.goldInc,a.textGold.pos(n.x,n.y),a.textGold.visible=!0,Laya.Tween.to(a.textGold,{y:a.textGold.y-120,scaleX:1.5,scaleY:1.5},800,Laya.Ease.linearOut,Laya.Handler.create(a,a._pickGold))),a.labelGold.changeText("x"+e.player.gold))}),"ad"==t?this.dialogTip.close():"gift"==t&&(this.dialogGift.close(),this.btnGift.visible=!1,Laya.SoundManager.playSound("sound/gold.mp3"))}},{key:"share",value:function(){var t=this;Laya.Browser.onMiniGame&&(wx.shareAppMessage({title:this._store.state.shareTitle,imageUrl:canvas.toTempFilePathSync({destWidth:500,destHeight:400})}),this._store.actions.earn("share").then(function(e){e.err||t.labelGold.changeText("x"+e.player.gold)}))}},{key:"diaryOpen",value:function(){Laya.SoundManager.playMusic("sound/bgm2.mp3"),this._director.pauseGame(),this._store.actions.restoreStoryIndex(),this.dialogDiary.getChildByName("aniCat").source="ani/cat/Cat"+this._store.state.player.level+".ani",this.dialogDiary.getChildByName("labelDiary").text=this._store.state.storyArr[this._store.state.player.level-1],this.dialogDiary.visible=!0,this.dialogDiary.show()}},{key:"diaryClose",value:function(){Laya.SoundManager.playMusic("sound/bgm.mp3"),this._director.continueGame()}},{key:"diaryLeft",value:function(){var e=this._store.actions.moveStoryIndex(-1);this.dialogDiary.getChildByName("aniCat").source="ani/cat/Cat"+(e+1)+".ani",this.dialogDiary.getChildByName("labelDiary").text=this._store.state.storyArr[e]}},{key:"diaryRight",value:function(){var e=this._store.actions.moveStoryIndex(1);this.dialogDiary.getChildByName("aniCat").source="ani/cat/Cat"+(e+1)+".ani",this.dialogDiary.getChildByName("labelDiary").text=this._store.state.storyArr[e]}},{key:"giftOpen",value:function(){this._director.pauseGame(),this.dialogGift.visible=!0,this.dialogGift.show()}},{key:"giftClose",value:function(){this._director.continueGame()}},{key:"updateExp",value:function(e){this.progressExp.value=e}},{key:"updatePrice",value:function(e){this.btnFood.label=e}},{key:"updateBtnFood",value:function(){this.btnFood.skin="ui/btn_cat.png"}}]),n}();n.default=r},{"../script/GameDirector":4}]},{},[2]);